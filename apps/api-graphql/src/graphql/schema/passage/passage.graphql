"""
A passage of text from a work
"""
type Passage {
  """
  Unique identifier for the passage
  """
  uuid: ID!

  """
  UUID of the work this passage belongs to
  """
  workUuid: ID!

  """
  Text content of the passage
  """
  content: String!

  """
  Display label for the passage (e.g., "1.1")
  """
  label: String

  """
  Sort order within the work
  """
  sort: Int!

  """
  Type of passage content (e.g., translation, introduction, colophon)
  """
  type: String!

  """
  XML ID from the source document
  """
  xmlId: String

  """
  Annotations marking up ranges within this passage
  """
  annotations: [Annotation!]!

  """
  Alignments linking this passage to Tibetan source text
  """
  alignments: [Alignment!]!

  """
  TipTap editor JSON representation of this passage.
  Transforms content and annotations into nested JSON structure.
  """
  json: JSON
}

"""
Filter options for passages
"""
input PassageFilter {
  """
  Filter by passage type (e.g., translation, introduction, colophon).
  Can be a single type or use LIKE pattern with %.
  """
  type: String

  """
  Filter by multiple passage types (OR logic).
  Use this instead of type when filtering by multiple types.
  """
  types: [String!]
}

"""
Direction for pagination
"""
enum PaginationDirection {
  """
  Fetch passages after the cursor (default)
  """
  FORWARD

  """
  Fetch passages before the cursor
  """
  BACKWARD

  """
  Fetch passages around the cursor (both before and after)
  """
  AROUND
}

"""
Paginated connection of passages
"""
type PassageConnection {
  """
  List of passages
  """
  nodes: [Passage!]!

  """
  Pagination information
  """
  pageInfo: PageInfo!

  """
  Cursor for fetching the next page
  """
  nextCursor: String @deprecated(reason: "Use pageInfo.nextCursor instead")

  """
  Cursor for fetching the previous page
  """
  prevCursor: String @deprecated(reason: "Use pageInfo.prevCursor instead")

  """
  Whether there are more passages after the current page
  """
  hasMoreAfter: Boolean!
    @deprecated(reason: "Use pageInfo.hasMoreAfter instead")

  """
  Whether there are more passages before the current page
  """
  hasMoreBefore: Boolean!
    @deprecated(reason: "Use pageInfo.hasMoreBefore instead")
}

extend type Query {
  """
  Fetch a single passage by UUID
  """
  passage(
    """
    The unique identifier of the passage
    """
    uuid: ID!
  ): Passage
}

"""
Input type for saving a passage
"""
input PassageInput {
  """
  Unique identifier for the passage
  """
  uuid: ID!

  """
  UUID of the work this passage belongs to
  """
  workUuid: ID!

  """
  Text content of the passage
  """
  content: String!

  """
  Display label for the passage
  """
  label: String!

  """
  Sort order within the work
  """
  sort: Int!

  """
  Type of passage content
  """
  type: String!

  """
  XML ID from the source document
  """
  xmlId: String

  """
  Annotations as JSON array
  """
  annotations: JSON!
}

"""
Result of saving passages
"""
type SavePassagesResult {
  """
  Whether the save was successful
  """
  success: Boolean!

  """
  Number of passages saved
  """
  savedCount: Int!

  """
  Error message if the save failed
  """
  error: String
}

extend type Mutation {
  """
  Save one or more passages.
  Requires editor.edit permission.
  """
  savePassages(passages: [PassageInput!]!): SavePassagesResult!
}
